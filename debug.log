2025-04-15 13:14:47,994 - INFO - Применены сплиты. Колонки: ['артикул', 'isrc', 'наименование', 'исполнитель', 'автор слов/музыки', 'доля авторских прав', 'доля смежных прав', 'площадка', 'тип контента', 'тип использования', 'вид использования', 'территория', 'дата реализации', 'кол-во', 'сумма реализации правообладателя', 'комиссия лицензиата', 'правообладатель вознаграждение итого', '_normalized_track_name', '_parsed_performers', 'gross', 'net', 'license_fee', 'rights_holder_total', 'правообладатель_вознаграждение_итого', 'комиссия_лицензиата', 'label_share', 'split_leraiie']
2025-04-15 13:14:47,997 - ERROR - Ошибка генерации отчета для leraiie: name 'generate_artist_report' is not defined
2025-04-15 13:22:01,276 - INFO - Данные после применения сплитов: 10 записей
2025-04-15 13:22:01,278 - INFO - Найдено артистов: 1
2025-04-15 13:22:01,363 - INFO - Создан отчет для: leraiie
2025-04-15 13:22:01,396 - CRITICAL - Критическая ошибка: name 'datetime' is not defined
Traceback (most recent call last):
  File "C:\Users\ALEX\source\repos\music-release-service\main.py", line 454, in generate_reports
    filename=f"music_reports_{datetime.now().strftime('%Y%m%d_%H%M')}.zip"
                              ^^^^^^^^
NameError: name 'datetime' is not defined. Did you forget to import 'datetime'?
2025-04-15 13:24:45,800 - INFO - Данные после применения сплитов: 10 записей
2025-04-15 13:24:45,802 - INFO - Найдено артистов: 1
2025-04-15 13:24:45,948 - INFO - Создан отчет для: leraiie
2025-04-15 13:44:28,282 - INFO - Начало обработки файла: ИП Беседин 3Q24.xlsx
2025-04-15 13:44:28,646 - ERROR - Критическая ошибка обработки файла: prepare_financial_data() missing 1 required positional argument: 'source_type'
2025-04-15 13:44:28,646 - ERROR - HTTP Error: Нет данных для генерации отчетов
2025-04-15 13:49:13,599 - INFO - Начало обработки файла: ИП Беседин 3Q24.xlsx
2025-04-15 13:49:13,900 - ERROR - Критическая ошибка обработки файла: 'decimal.Decimal' object has no attribute 'apply'
2025-04-15 13:49:13,900 - ERROR - HTTP Error: Нет данных для генерации отчетов
2025-04-15 13:54:35,391 - INFO - Начало обработки файла: ИП Беседин 3Q24.xlsx
2025-04-15 13:54:35,706 - ERROR - Критическая ошибка обработки файла: 'decimal.Decimal' object has no attribute 'apply'
2025-04-15 13:54:35,707 - ERROR - HTTP Error: Нет данных для генерации отчетов
2025-04-15 13:57:24,309 - INFO - Начало обработки файла: ИП Беседин 3Q24.xlsx
2025-04-15 13:57:24,628 - ERROR - Ошибка преобразования данных: 'int' object has no attribute 'apply'
2025-04-15 13:57:24,628 - ERROR - Ошибка валидации: Ошибка обработки финансовых данных
2025-04-15 13:57:24,628 - ERROR - HTTP Error: Ошибка обработки финансовых данных
2025-04-15 13:59:55,374 - INFO - Начало обработки файла: ИП Беседин 3Q24.xlsx
2025-04-15 13:59:55,706 - ERROR - Файл ИП Беседин 3Q24.xlsx не содержит: gross, rights_holder_total
2025-04-15 13:59:55,706 - ERROR - Ошибка валидации: Файл ИП Беседин 3Q24.xlsx не содержит: gross, rights_holder_total
2025-04-15 13:59:55,707 - ERROR - HTTP Error: Файл ИП Беседин 3Q24.xlsx не содержит: gross, rights_holder_total
2025-04-15 14:01:55,248 - INFO - Начало обработки файла: ИП Беседин 3Q24.xlsx
2025-04-15 14:01:55,562 - INFO - Колонки в файле ИП Беседин 3Q24.xlsx: ['артикул', 'isrc', 'наименование', 'исполнитель', 'автор слов/музыки', 'доля авторских прав', 'доля смежных прав', 'площадка', 'тип контента', 'тип использования', 'вид использования', 'территория', 'дата реализации', 'кол-во', 'сумма реализации правообладателя', 'комиссия лицензиата', 'правообладатель вознаграждение итого']
2025-04-15 14:01:55,563 - ERROR - Ошибка обработки файла ИП Беседин 3Q24.xlsx: 400: Файл ИП Беседин 3Q24.xlsx не содержит обязательные колонки: комиссия_лицензиата, правообладатель_вознаграждение_итого
2025-04-15 14:01:55,563 - ERROR - Ошибка валидации: Файл ИП Беседин 3Q24.xlsx не содержит обязательные колонки: комиссия_лицензиата, правообладатель_вознаграждение_итого
2025-04-15 14:01:55,563 - ERROR - HTTP Error: Файл ИП Беседин 3Q24.xlsx не содержит обязательные колонки: комиссия_лицензиата, правообладатель_вознаграждение_итого
2025-04-15 14:02:21,717 - INFO - Начало обработки файла: ИП Беседин 3Q24.xlsx
2025-04-15 14:02:21,989 - INFO - Колонки в файле ИП Беседин 3Q24.xlsx: ['артикул', 'isrc', 'наименование', 'исполнитель', 'автор слов/музыки', 'доля авторских прав', 'доля смежных прав', 'площадка', 'тип контента', 'тип использования', 'вид использования', 'территория', 'дата реализации', 'кол-во', 'сумма реализации правообладателя', 'комиссия лицензиата', 'правообладатель вознаграждение итого']
2025-04-15 14:02:21,991 - ERROR - Файл ИП Беседин 3Q24.xlsx не содержит: _normalized_track_name, _parsed_performers, gross, rights_holder_total
2025-04-15 14:02:21,991 - ERROR - Ошибка валидации: Файл ИП Беседин 3Q24.xlsx не содержит: _normalized_track_name, _parsed_performers, gross, rights_holder_total
2025-04-15 14:02:21,991 - ERROR - HTTP Error: Файл ИП Беседин 3Q24.xlsx не содержит: _normalized_track_name, _parsed_performers, gross, rights_holder_total
2025-04-15 14:53:08,352 - INFO - Начало обработки файла: ИП Беседин 3Q24.xlsx
2025-04-15 14:53:08,693 - INFO - Нормализованные колонки: ['артикул', 'isrc', 'наименование', 'исполнитель', 'автор_слов/музыки', 'доля_авторских_прав', 'доля_смежных_прав', 'площадка', 'тип_контента', 'тип_использования', 'вид_использования', 'территория', 'дата_реализации', 'кол_во', 'сумма_реализации_правообладателя', 'комиссия_лицензиата', 'правообладатель_вознаграждение_итого']
2025-04-15 14:53:08,701 - ERROR - Ошибка в данных: "['_normalized_track_name', '_parsed_performers'] not in index"
2025-04-15 14:53:08,702 - ERROR - Ошибка обработки файла: 400: Некорректная структура отчета: "['_normalized_track_name', '_parsed_performers'] not in index"
2025-04-15 14:53:08,702 - ERROR - Ошибка валидации: 400: Некорректная структура отчета: "['_normalized_track_name', '_parsed_performers'] not in index"
2025-04-15 14:53:08,702 - ERROR - HTTP Error: 400: Некорректная структура отчета: "['_normalized_track_name', '_parsed_performers'] not in index"
2025-04-15 15:49:33,026 - INFO - Начало обработки файла: ИП Беседин 3Q24.xlsx
2025-04-15 15:49:33,319 - INFO - Нормализованные колонки: ['артикул', 'isrc', 'наименование', 'исполнитель', 'автор_слов/музыки', 'доля_авторских_прав', 'доля_смежных_прав', 'площадка', 'тип_контента', 'тип_использования', 'вид_использования', 'территория', 'дата_реализации', 'кол_во', 'сумма_реализации_правообладателя', 'комиссия_лицензиата', 'правообладатель_вознаграждение_итого']
2025-04-15 15:49:33,321 - ERROR - Ошибка обработки файла: name 'parse_performers' is not defined
2025-04-15 15:49:33,321 - ERROR - Ошибка валидации: name 'parse_performers' is not defined
2025-04-15 15:49:33,322 - ERROR - HTTP Error: name 'parse_performers' is not defined
2025-04-15 16:08:41,724 - INFO - Начало обработки файла: ИП Беседин 3Q24.xlsx
2025-04-15 16:08:42,048 - INFO - Нормализованные колонки: ['артикул', 'isrc', 'наименование', 'исполнитель', 'автор_слов/музыки', 'доля_авторских_прав', 'доля_смежных_прав', 'площадка', 'тип_контента', 'тип_использования', 'вид_использования', 'территория', 'дата_реализации', 'кол_во', 'сумма_реализации_правообладателя', 'комиссия_лицензиата', 'правообладатель_вознаграждение_итого']
2025-04-15 16:08:42,050 - ERROR - Ошибка обработки файла: name 'parse_performers' is not defined
2025-04-15 16:08:42,051 - ERROR - Ошибка валидации: name 'parse_performers' is not defined
2025-04-15 16:08:42,051 - ERROR - HTTP Error: name 'parse_performers' is not defined
2025-04-15 16:11:23,151 - INFO - Начало обработки файла: ИП Беседин 3Q24.xlsx
2025-04-15 16:11:23,470 - INFO - Нормализованные колонки: ['артикул', 'isrc', 'наименование', 'исполнитель', 'автор_слов/музыки', 'доля_авторских_прав', 'доля_смежных_прав', 'площадка', 'тип_контента', 'тип_использования', 'вид_использования', 'территория', 'дата_реализации', 'кол_во', 'сумма_реализации_правообладателя', 'комиссия_лицензиата', 'правообладатель_вознаграждение_итого']
2025-04-15 16:11:23,478 - ERROR - Файл ИП Беседин 3Q24.xlsx не содержит: gross, rights_holder_total
2025-04-15 16:11:23,479 - ERROR - Ошибка валидации: Файл ИП Беседин 3Q24.xlsx не содержит: gross, rights_holder_total
2025-04-15 16:11:23,479 - ERROR - HTTP Error: Файл ИП Беседин 3Q24.xlsx не содержит: gross, rights_holder_total
2025-04-15 16:18:04,166 - INFO - Начало обработки файла: ИП Беседин 3Q24.xlsx
2025-04-15 16:18:04,475 - INFO - Нормализованные колонки: ['артикул', 'isrc', 'наименование', 'исполнитель', 'автор_слов/музыки', 'доля_авторских_прав', 'доля_смежных_прав', 'площадка', 'тип_контента', 'тип_использования', 'вид_использования', 'территория', 'дата_реализации', 'кол_во', 'сумма_реализации_правообладателя', 'комиссия_лицензиата', 'правообладатель_вознаграждение_итого']
2025-04-15 16:18:04,479 - ERROR - Файл ИП Беседин 3Q24.xlsx не содержит: gross, rights_holder_total
2025-04-15 16:18:04,479 - ERROR - Ошибка валидации: Файл ИП Беседин 3Q24.xlsx не содержит: gross, rights_holder_total
2025-04-15 16:18:04,479 - ERROR - HTTP Error: Файл ИП Беседин 3Q24.xlsx не содержит: gross, rights_holder_total
2025-04-15 16:22:01,907 - INFO - Начало обработки файла: ИП Беседин 3Q24.xlsx
2025-04-15 16:22:02,215 - INFO - Нормализованные колонки: ['артикул', 'isrc', 'наименование', 'исполнитель', 'автор_слов/музыки', 'доля_авторских_прав', 'доля_смежных_прав', 'площадка', 'тип_контента', 'тип_использования', 'вид_использования', 'территория', 'дата_реализации', 'кол_во', 'сумма_реализации_правообладателя', 'комиссия_лицензиата', 'правообладатель_вознаграждение_итого']
2025-04-15 16:22:02,217 - INFO - Колонка gross инициализирована нулями
2025-04-15 16:22:02,218 - INFO - Колонка net инициализирована нулями
2025-04-15 16:22:02,220 - ERROR - Файл ИП Беседин 3Q24.xlsx не содержит: gross, rights_holder_total
2025-04-15 16:22:02,220 - ERROR - Ошибка валидации: Файл ИП Беседин 3Q24.xlsx не содержит: gross, rights_holder_total
2025-04-15 16:22:02,220 - ERROR - HTTP Error: Файл ИП Беседин 3Q24.xlsx не содержит: gross, rights_holder_total
2025-04-15 16:26:28,511 - INFO - Начало обработки файла: ИП Беседин 3Q24.xlsx
2025-04-15 16:26:28,870 - INFO - Нормализованные колонки: ['артикул', 'isrc', 'наименование', 'исполнитель', 'автор_слов/музыки', 'доля_авторских_прав', 'доля_смежных_прав', 'площадка', 'тип_контента', 'тип_использования', 'вид_использования', 'территория', 'дата_реализации', 'кол_во', 'сумма_реализации_правообладателя', 'комиссия_лицензиата', 'правообладатель_вознаграждение_итого']
2025-04-15 16:26:28,872 - ERROR - Финансовая ошибка: 'bool' object has no attribute 'lower'
2025-04-15 16:26:28,872 - ERROR - Ошибка обработки файла: 500: Ошибка обработки файла: 'bool' object has no attribute 'lower'
2025-04-15 16:26:28,873 - ERROR - Ошибка валидации: 500: Ошибка обработки файла: 'bool' object has no attribute 'lower'
2025-04-15 16:26:28,873 - ERROR - HTTP Error: 500: Ошибка обработки файла: 'bool' object has no attribute 'lower'
2025-04-15 16:31:53,859 - INFO - Начало обработки файла: ИП Беседин 3Q24.xlsx
2025-04-15 16:31:54,164 - INFO - Нормализованные колонки: ['артикул', 'isrc', 'наименование', 'исполнитель', 'автор_слов/музыки', 'доля_авторских_прав', 'доля_смежных_прав', 'площадка', 'тип_контента', 'тип_использования', 'вид_использования', 'территория', 'дата_реализации', 'кол_во', 'сумма_реализации_правообладателя', 'комиссия_лицензиата', 'правообладатель_вознаграждение_итого']
2025-04-15 16:31:54,167 - INFO - Инициализирована колонка gross
2025-04-15 16:31:54,167 - INFO - Инициализирована колонка net
2025-04-15 16:31:54,168 - ERROR - Критическая ошибка обработки: 'int' object has no attribute 'apply'
Traceback (most recent call last):
  File "C:\Users\ALEX\source\repos\music-release-service\main.py", line 219, in process_report
    df = apply_splits(df, db)
  File "C:\Users\ALEX\source\repos\music-release-service\main.py", line 296, in apply_splits
    df['label_share'] = df.get('label_share', 0).apply(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'int' object has no attribute 'apply'
2025-04-15 16:31:54,171 - ERROR - Ошибка валидации: Невозможно обработать файл: 'int' object has no attribute 'apply'
2025-04-15 16:31:54,171 - ERROR - HTTP Error: Невозможно обработать файл: 'int' object has no attribute 'apply'
2025-04-15 16:38:48,096 - INFO - Начало обработки файла: ИП Беседин 3Q24.xlsx
2025-04-15 16:38:48,430 - ERROR - Не удалось определить трек: {'Артикул': 7259678, 'ISRC': 'FR10S2441963', 'Наименование': 'Падаю', 'Исполнитель': 'Leraiie', 'Автор слов/музыки': 'Глушенков Вячеслав Сергеевич', 'Доля авторских прав': 100, 'Доля смежных прав': 100, 'Площадка': 'iTunes', 'Тип контента': nan, 'Тип использования': nan, 'Вид использования': 'download', 'Территория': 'RU', 'Дата реализации': '01.01.2024 - 31.01.2024', 'Кол-во': 1, 'Сумма реализации Правообладателя': 1.833, 'Комиссия Лицензиата': 0.3666, 'Правообладатель вознаграждение итого': 1.4664}
2025-04-15 16:38:48,431 - ERROR - Не удалось определить трек: {'Артикул': 7259678, 'ISRC': 'FR10S2441963', 'Наименование': 'Падаю', 'Исполнитель': 'Leraiie', 'Автор слов/музыки': 'Глушенков Вячеслав Сергеевич', 'Доля авторских прав': 100, 'Доля смежных прав': 100, 'Площадка': 'ОМА', 'Тип контента': 'Subscription', 'Тип использования': nan, 'Вид использования': 'streaming', 'Территория': 'CIS/RU', 'Дата реализации': '01.04.2024 - 30.04.2024', 'Кол-во': 1933, 'Сумма реализации Правообладателя': 28.3205, 'Комиссия Лицензиата': 5.6641, 'Правообладатель вознаграждение итого': 22.6564}
2025-04-15 16:38:48,432 - ERROR - Не удалось определить трек: {'Артикул': 7259678, 'ISRC': 'FR10S2441963', 'Наименование': 'Падаю', 'Исполнитель': 'Leraiie', 'Автор слов/музыки': 'Глушенков Вячеслав Сергеевич', 'Доля авторских прав': 100, 'Доля смежных прав': 100, 'Площадка': 'ОМА', 'Тип контента': 'Subscription', 'Тип использования': nan, 'Вид использования': 'streaming', 'Территория': 'CIS/RU', 'Дата реализации': '01.05.2024 - 31.05.2024', 'Кол-во': 1438, 'Сумма реализации Правообладателя': 21.7852, 'Комиссия Лицензиата': 4.357, 'Правообладатель вознаграждение итого': 17.4282}
2025-04-15 16:38:48,432 - ERROR - Не удалось определить трек: {'Артикул': 7259678, 'ISRC': 'FR10S2441963', 'Наименование': 'Падаю', 'Исполнитель': 'Leraiie', 'Автор слов/музыки': 'Глушенков Вячеслав Сергеевич', 'Доля авторских прав': 100, 'Доля смежных прав': 100, 'Площадка': 'ОМА', 'Тип контента': 'Subscription', 'Тип использования': nan, 'Вид использования': 'streaming', 'Территория': 'CIS/RU', 'Дата реализации': '01.06.2024 - 30.06.2024', 'Кол-во': 1159, 'Сумма реализации Правообладателя': 19.0215, 'Комиссия Лицензиата': 3.8043, 'Правообладатель вознаграждение итого': 15.2172}
2025-04-15 16:38:48,433 - ERROR - Не удалось определить трек: {'Артикул': 7259678, 'ISRC': 'FR10S2441963', 'Наименование': 'Падаю', 'Исполнитель': 'Leraiie', 'Автор слов/музыки': 'Глушенков Вячеслав Сергеевич', 'Доля авторских прав': 100, 'Доля смежных прав': 100, 'Площадка': 'ОМА', 'Тип контента': 'Subscription', 'Тип использования': nan, 'Вид использования': 'streaming', 'Территория': 'CIS/RU', 'Дата реализации': '01.04.2024 - 30.04.2024', 'Кол-во': 10966, 'Сумма реализации Правообладателя': 297.5502, 'Комиссия Лицензиата': 59.51, 'Правообладатель вознаграждение итого': 238.0402}
2025-04-15 16:38:48,433 - ERROR - Не удалось определить трек: {'Артикул': 7259678, 'ISRC': 'FR10S2441963', 'Наименование': 'Падаю', 'Исполнитель': 'Leraiie', 'Автор слов/музыки': 'Глушенков Вячеслав Сергеевич', 'Доля авторских прав': 100, 'Доля смежных прав': 100, 'Площадка': 'ОМА', 'Тип контента': 'Subscription', 'Тип использования': nan, 'Вид использования': 'streaming', 'Территория': 'CIS/RU', 'Дата реализации': '01.05.2024 - 31.05.2024', 'Кол-во': 8573, 'Сумма реализации Правообладателя': 247.6454, 'Комиссия Лицензиата': 49.5291, 'Правообладатель вознаграждение итого': 198.1163}
2025-04-15 16:38:48,434 - ERROR - Не удалось определить трек: {'Артикул': 7259678, 'ISRC': 'FR10S2441963', 'Наименование': 'Падаю', 'Исполнитель': 'Leraiie', 'Автор слов/музыки': 'Глушенков Вячеслав Сергеевич', 'Доля авторских прав': 100, 'Доля смежных прав': 100, 'Площадка': 'ОМА', 'Тип контента': 'Subscription', 'Тип использования': nan, 'Вид использования': 'streaming', 'Территория': 'CIS/RU', 'Дата реализации': '01.06.2024 - 30.06.2024', 'Кол-во': 7076, 'Сумма реализации Правообладателя': 218.3658, 'Комиссия Лицензиата': 43.6732, 'Правообладатель вознаграждение итого': 174.6926}
2025-04-15 16:38:48,434 - ERROR - Не удалось определить трек: {'Артикул': 7259678, 'ISRC': 'FR10S2441963', 'Наименование': 'Падаю', 'Исполнитель': 'Leraiie', 'Автор слов/музыки': 'Глушенков Вячеслав Сергеевич', 'Доля авторских прав': 100, 'Доля смежных прав': 100, 'Площадка': 'ОМА', 'Тип контента': 'Advertisiment ', 'Тип использования': nan, 'Вид использования': 'streaming', 'Территория': 'CIS/RU', 'Дата реализации': '01.04.2024 - 30.04.2024', 'Кол-во': 18763, 'Сумма реализации Правообладателя': 18.763, 'Комиссия Лицензиата': 3.7526, 'Правообладатель вознаграждение итого': 15.0104}
2025-04-15 16:38:48,435 - ERROR - Не удалось определить трек: {'Артикул': 7259678, 'ISRC': 'FR10S2441963', 'Наименование': 'Падаю', 'Исполнитель': 'Leraiie', 'Автор слов/музыки': 'Глушенков Вячеслав Сергеевич', 'Доля авторских прав': 100, 'Доля смежных прав': 100, 'Площадка': 'ОМА', 'Тип контента': 'Advertisiment ', 'Тип использования': nan, 'Вид использования': 'streaming', 'Территория': 'CIS/RU', 'Дата реализации': '01.05.2024 - 31.05.2024', 'Кол-во': 14873, 'Сумма реализации Правообладателя': 14.873, 'Комиссия Лицензиата': 2.9746, 'Правообладатель вознаграждение итого': 11.8984}
2025-04-15 16:38:48,436 - ERROR - Не удалось определить трек: {'Артикул': 7259678, 'ISRC': 'FR10S2441963', 'Наименование': 'Падаю', 'Исполнитель': 'Leraiie', 'Автор слов/музыки': 'Глушенков Вячеслав Сергеевич', 'Доля авторских прав': 100, 'Доля смежных прав': 100, 'Площадка': 'Yandex', 'Тип контента': nan, 'Тип использования': 'MTS Music', 'Вид использования': 'streaming', 'Территория': 'CIS/RU', 'Дата реализации': '01.04.2024 - 30.06.2024', 'Кол-во': 1081, 'Сумма реализации Правообладателя': 8.5024, 'Комиссия Лицензиата': 1.7005, 'Правообладатель вознаграждение итого': 6.8019}
2025-04-15 16:38:48,438 - INFO - Инициализирована колонка gross
2025-04-15 16:38:48,439 - INFO - Инициализирована колонка net
2025-04-15 16:38:48,440 - INFO - Инициализирована колонка правообладатель_вознаграждение_итого
2025-04-15 16:38:48,440 - INFO - Инициализирована колонка комиссия_лицензиата
2025-04-15 16:38:48,442 - ERROR - Ошибка обработки: 'int' object has no attribute 'apply'
Traceback (most recent call last):
  File "C:\Users\ALEX\source\repos\music-release-service\main.py", line 220, in process_report
    df = apply_splits(df, db)
  File "C:\Users\ALEX\source\repos\music-release-service\main.py", line 304, in apply_splits
    df['label_share'] = df.get('label_share', 0).apply(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'int' object has no attribute 'apply'
2025-04-15 16:38:48,445 - ERROR - Ошибка валидации: Ошибка обработки файла: 'int' object has no attribute 'apply'
2025-04-15 16:38:48,446 - ERROR - HTTP Error: Ошибка обработки файла: 'int' object has no attribute 'apply'
2025-04-15 16:44:06,819 - INFO - Начало обработки файла: ИП Беседин 3Q24.xlsx
2025-04-15 16:44:07,162 - INFO - Нормализованные колонки: ['артикул', 'isrc', 'наименование', 'исполнитель', 'автор_слов/музыки', 'доля_авторских_прав', 'доля_смежных_прав', 'площадка', 'тип_контента', 'тип_использования', 'вид_использования', 'территория', 'дата_реализации', 'кол_во', 'сумма_реализации_правообладателя', 'комиссия_лицензиата', 'правообладатель_вознаграждение_итого']
2025-04-15 16:44:07,164 - INFO - Инициализирована колонка gross
2025-04-15 16:44:07,164 - INFO - Инициализирована колонка net
2025-04-15 16:44:07,329 - ERROR - Файл ИП Беседин 3Q24.xlsx не содержит: rights_holder_total
2025-04-15 16:44:07,330 - ERROR - Ошибка валидации: Файл ИП Беседин 3Q24.xlsx не содержит: rights_holder_total
2025-04-15 16:44:07,330 - ERROR - HTTP Error: Файл ИП Беседин 3Q24.xlsx не содержит: rights_holder_total
2025-04-15 17:37:57,057 - INFO - Начало обработки файла: ИП Беседин 3Q24.xlsx
2025-04-15 17:37:57,349 - INFO - Нормализованные колонки: ['артикул', 'isrc', 'наименование', 'исполнитель', 'автор_слов/музыки', 'доля_авторских_прав', 'доля_смежных_прав', 'площадка', 'тип_контента', 'тип_использования', 'вид_использования', 'территория', 'дата_реализации', 'кол_во', 'сумма_реализации_правообладателя', 'комиссия_лицензиата', 'правообладатель_вознаграждение_итого']
2025-04-15 17:37:57,350 - INFO - Инициализирована колонка gross
2025-04-15 17:37:57,351 - INFO - Инициализирована колонка net
2025-04-15 17:37:57,351 - INFO - Инициализирована колонка rights_holder_total
2025-04-15 17:37:57,436 - ERROR - Ошибка сплитов: '_normalized_track_name'
Traceback (most recent call last):
  File "C:\Users\ALEX\source\repos\music-release-service\venv\Lib\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: '_normalized_track_name'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\ALEX\source\repos\music-release-service\main.py", line 336, in apply_splits
    track_norm = normalize_artist_name(row['_normalized_track_name'])
                                       ~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ALEX\source\repos\music-release-service\venv\Lib\site-packages\pandas\core\series.py", line 1121, in __getitem__
    return self._get_value(key)
           ~~~~~~~~~~~~~~~^^^^^
  File "C:\Users\ALEX\source\repos\music-release-service\venv\Lib\site-packages\pandas\core\series.py", line 1237, in _get_value
    loc = self.index.get_loc(label)
  File "C:\Users\ALEX\source\repos\music-release-service\venv\Lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: '_normalized_track_name'
2025-04-15 17:37:57,444 - ERROR - Ошибка валидации: Ошибка распределения долей
2025-04-15 17:37:57,445 - ERROR - HTTP Error: Ошибка распределения долей
2025-04-15 20:34:43,811 - INFO - Начало обработки файла: ИП Беседин 3Q24.xlsx
2025-04-15 20:34:44,113 - INFO - Нормализованные колонки: ['артикул', 'isrc', 'наименование', 'исполнитель', 'автор_слов/музыки', 'доля_авторских_прав', 'доля_смежных_прав', 'площадка', 'тип_контента', 'тип_использования', 'вид_использования', 'территория', 'дата_реализации', 'кол_во', 'сумма_реализации_правообладателя', 'комиссия_лицензиата', 'правообладатель_вознаграждение_итого']
2025-04-15 20:34:44,114 - INFO - Колонка _normalized_track_name создана
2025-04-15 20:34:44,115 - INFO - Инициализирована колонка gross
2025-04-15 20:34:44,115 - INFO - Инициализирована колонка net
2025-04-15 20:34:44,116 - INFO - Инициализирована колонка rights_holder_total
2025-04-15 20:34:44,117 - WARNING - Колонка _parsed_performers создана принудительно
2025-04-15 20:34:44,205 - ERROR - Файл ИП Беседин 3Q24.xlsx не содержит: gross, rights_holder_total
2025-04-15 20:34:44,206 - ERROR - Ошибка валидации: Файл ИП Беседин 3Q24.xlsx не содержит: gross, rights_holder_total
2025-04-15 20:34:44,206 - ERROR - HTTP Error: Файл ИП Беседин 3Q24.xlsx не содержит: gross, rights_holder_total
2025-04-15 22:25:34,712 - INFO - Создана колонка gross = 0
2025-04-15 22:25:34,713 - INFO - Создана колонка net = 0
2025-04-15 22:25:34,714 - INFO - Создана колонка rights_holder_total = 0
2025-04-15 22:25:34,714 - INFO - Создана колонка label_share = 0
2025-04-15 22:25:34,714 - INFO - Создана колонка прибыль_лицензиата = 0
2025-04-15 22:25:34,715 - INFO - Создана колонка прибыль_лицензиара = 0
2025-04-15 22:25:34,939 - ERROR - Финальная ошибка: 'Артист'
